<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professor Reviews - ProfDex</title>
    <link rel="stylesheet" href="navbar.css">
    <link rel="stylesheet" href="reviewlist.css">
</head>
<body>
    <div class="page-container">
        {{#with professorData}}
        <div class="professor-header">
            <div class="header-content">
                <h1 class="professor-title">{{aProfessor.title}} {{aProfessor.lastname}}</h1>
                <p class="professor-subtitle">Professor Reviews & Ratings</p>
                <a href="/viewprof?id={{../professorData._id}}" class="view-profile-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4.5C7 4.5 2.73 7.61 1 12C2.73 16.39 7 19.5 12 19.5C17 19.5 21.27 16.39 23 12C21.27 7.61 17 4.5 12 4.5ZM12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17ZM12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z" fill="currentColor"/>
                    </svg>
                    View Profile
                </a>
            </div>
        </div>
        {{/with}}

        <div class="main-container">
        <div class="reviews-section">
            <div class="section-header">
                <h2>Student Reviews</h2>
                <p>See what students say about this professor</p>
            </div>
            
            <div class="reviews-grid">
                {{#each postData}}
                <div class="review-card">
                    <div class="review-header">
                        <div class="review-author">
                            <span class="author-name">{{opname}}</span>
                            {{#if (eq ../postUserTypes.[@index] 'manager')}}
                            <span class="author-badge manager">Manager</span>
                            {{/if}}
                        </div>
                        {{#if (eq ../userType 'manager')}}
                        <form action="/delete-review-and-comments" method="POST" class="delete-form">
                            <input type="hidden" name="reviewId" value="{{_id}}">
                            <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this review?')">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                </svg>
                            </button>
                        </form>
                        {{/if}}
                    </div>
                    
                    <div class="ratings-section">
                        <div class="rating-item">
                            <div class="rating-icon" id="generosity"></div>
                            <div class="rating-bar">
                                <div class="bar-fill" style="height: {{multiply (divide generosity 2) 20}}%"></div>
                            </div>
                                                            <span class="rating-value">{{divide generosity 2}}/5</span>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-icon" id="workload"></div>
                            <div class="rating-bar">
                                <div class="bar-fill" style="height: {{multiply (divide workload 2) 20}}%"></div>
                            </div>
                                                            <span class="rating-value">{{divide workload 2}}/5</span>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-icon" id="proficiency"></div>
                            <div class="rating-bar">
                                <div class="bar-fill" style="height: {{multiply (divide proficiency 2) 20}}%"></div>
                            </div>
                                                            <span class="rating-value">{{divide proficiency 2}}/5</span>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-icon" id="difficulty"></div>
                            <div class="rating-bar">
                                <div class="bar-fill" style="height: {{multiply (divide difficulty 2) 20}}%"></div>
                            </div>
                                                            <span class="rating-value">{{divide difficulty 2}}/5</span>
                        </div>
                        
                        <div class="rating-item">
                            <div class="rating-icon" id="engagement"></div>
                            <div class="rating-bar">
                                <div class="bar-fill" style="height: {{multiply (divide engagement 2) 20}}%"></div>
                            </div>
                                                            <span class="rating-value">{{divide engagement 2}}/5</span>
                        </div>
                    </div>
                    
                    <div class="review-actions">
                        <a href="/viewreview?id={{_id}}" class="view-review-btn">View Full Review</a>
                    </div>
                </div>
                {{/each}}
            </div>
            
            {{#unless postData.length}}
            {{#unless (eq userType 'professor')}}
            <div class="no-reviews">
                <div class="no-reviews-icon">üìù</div>
                <h3>No Reviews Yet</h3>
                <p>Be the first to review this professor!</p>
                <a href="/createpost" class="create-review-btn">Create Review</a>
            </div>
            {{/unless}}
            {{/unless}}
        </div>
    </div>
    </div>
    
    <div id="navbar">
        <a class="mainpage" href="/">Profdex</a>
        <span class="navbar-buttons">
            <a class="menu" href="/editprofile">About Me</a>
            {{#if (ne userType 'professor')}}
            <a class="menu" href="/createpost">Create Review</a>
            {{/if}}
            <a class="menu" href="/help">Help</a>
        </span>
        <span class="search-buttons">
            {{#if loggedInUser}}
                <a class="login-button" href="/logout">Logout</a>
            {{else}}
                <a class="login-button" href="/login">Login</a>
            {{/if}}
            {{#if (or (eq userType 'manager') (eq userType 'administrator'))}}
            <a class="moderator-link" href="/moderator">Moderator</a>
            {{/if}}
            <a class="admin-link" href="/admin/login">Admin</a>
            <form action="/viewprof" method="post">
                <input type="text" class="search" id="search" name="search" placeholder="Professor Full Name">
                <button type="submit" id="searchbutton"></button>
            </form>
        </span>
    </div>
</body>
</html>