<html>
<head>
	<link rel="stylesheet" href="navbar.css">
	<link rel="stylesheet" href="viewreview.css">
</head>

<body>
	<div id="navbar">
		<a class="mainpage" href="/">Profdex</a>
		<span class="navbar-buttons">
			<a class="menu" href="/editprofile">About Me</a>
			{{#if (and (ne userType 'professor') (ne userType 'manager'))}}
			<a class="menu" href="/createpost">Create Review</a>
			{{/if}}
			<a class="menu" href="/help">Help</a>
		</span>
		<span class="search-buttons">
			{{#if loggedInUser}}
				<a class="login-button" href="/logout">Logout</a>
			{{else}}
				<a class="login-button" href="/login">Login</a>
			{{/if}}
			<form action="/viewprof" method="post">
				<input type="text" class="search" id="search" name="search" placeholder="Professor Full Name">
				<button type="submit" id="searchbutton"></button>
			</form>
		</span>
	</div>


	<div id="filter">
		{{#with professorData}}
			<a id="professorname" href="/viewprof?id={{_id}}" style="position: absolute; margin-top: 10px; margin-left: 100px;">{{aProfessor.title}} {{aProfessor.lastname}}</a>
		{{/with}}
		{{#with postData}}
			<a class="filter" style="margin-top: 37px; margin-left: 100px;">{{course}}</a>
		{{/with}}
	</div>


	<div style="display: flex; flex-direction: column; align-items: center; width: 100%; margin-top: 100px;">
		<h2 style="align-self: flex-start; margin-left: 100px; color: #e65c00; font-family: 'proxima_nova_rgbold';">Review</h2>
		{{#with postData}}
		<div class="container" style="width: 80%; background: #fff; border-radius: 10px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); display: flex; flex-direction: row; align-items: flex-start; padding: 32px 24px; margin-bottom: 32px;">
			<div class="actual-review-container" style="max-width: 270px;">
				<div id="review">
					<div class="review-header">
						<a class="review-author" href="/viewuser?id={{op}}">By: {{opname}}</a>
					</div>
					<img id="generosity" src="images/transparent.png" width="1" height="1" style="margin-left: 20px; margin-top: 225px;">
					<div class="bar" style="margin-top: 200px; margin-left: 22px; width: 25px; transform-origin: bottom; transform: scaleY({{generosity}}); background-color: green">&nbsp</div>
					<img id="workload" src="images/transparent.png" width="1" height="1" style="margin-left: 68px; margin-top: 225px;">
					<div class="bar" style="margin-top: 200px; margin-left: 71px; width: 25px; transform-origin: bottom; transform: scaleY({{workload}}); background-color: green">&nbsp</div>
					<img id="proficiency" src="images/transparent.png" width="1" height="1" style="margin-left: 115px; margin-top: 225px;">
					<div class="bar" style="margin-top: 200px; margin-left: 119px; width: 25px; transform-origin: bottom; transform: scaleY({{proficiency}}); background-color: green">&nbsp</div>
					<img id="difficulty" src="images/transparent.png" width="1" height="1" style="margin-left: 160px; margin-top: 225px;">
					<div class="bar" style="margin-top: 200px; margin-left: 168px; width: 25px; transform-origin: bottom; transform: scaleY({{difficulty}}); background-color: green">&nbsp</div>
					<img id="engagement" src="images/transparent.png" width="1" height="1" style="margin-left: 210px; margin-top: 225px;">
					<div class="bar" style="margin-top: 200px; margin-left: 214px; width: 25px; transform-origin: bottom; transform: scaleY({{engagement}}); background-color: green">&nbsp</div>
				</div>
			</div>
			<div class="review-text" style="background: #f9f9f9; border-radius: 10px; box-shadow: 0 1px 6px rgba(0,0,0,0.04); margin-left: 40px; padding: 20px; width: 100%; min-height: 120px; max-height: 260px; overflow-y: auto; display: flex; align-items: flex-start;">
				<span class="text" style="font-size: 1.1rem; color: #595959; word-break: break-word;">{{aPost.text}}</span>
			</div>

		</div>
		{{/with}}

		<h2 style="align-self: flex-start; margin-left: 100px; color: #e65c00; font-family: 'proxima_nova_rgbold';">Comments</h2>
		<div id="lot" style="margin-bottom: 40px; width: 80%;">
			{{#if commentData.length}}
				{{#each commentData}}
				<div class="container" style="background: #fff; border-radius: 8px; box-shadow: 0 1px 6px rgba(0,0,0,0.07); padding: 18px 24px 12px 24px; max-width: 100%; margin-bottom: 18px;">
					<div class="comment-header" style="display: flex; align-items: center;">
						<a class="comment-profile" href="/viewuser?id={{op}}" style="margin-right: 10px;"></a>
						<a class="comment-username" href="/viewuser?id={{op}}" style="font-weight: bold; color: #e65c00; margin-right: 10px;">{{opname}}</a>
						<span style="color: #888; font-size: 0.95em; margin-right: 10px;">@{{toname}} ({{to}}) - {{date}}</span>
						{{#if (or (eq op ../loggedInUser._id) (eq ../userType 'manager'))}}
						<form action="/deletecomment" method="POST" style="display:inline; margin-left: 10px;">
							<input type="hidden" name="commentId" value="{{_id}}">
							<input type="hidden" name="postId" value="{{post}}">
							<button type="submit" class="delete-comment" style="color:red; background: none; border: none; cursor: pointer;">Delete</button>
						</form>
						{{/if}}
					</div>
					<div class="text-comment" style="margin-top: 8px; color: #444; font-size: 1.05em;">{{aComment.text}}</div>
				</div>
				{{/each}}
			{{else}}
				<div style="margin-left:10px; color: #888; font-size: 1.1em;">No comments yet. Be the first to comment!</div>
			{{/if}}
		</div>
		<div>
	   <form action="/reply" method="post" style="display: flex; flex-direction: column; min-width: 500px; margin-left: 100px; margin-top: 0; padding: 20px; background: #f9f9f9; border-radius: 8px; box-shadow: 0 1px 6px rgba(0,0,0,0.07);">
		   <label for="comment" style="font-weight: bold; margin-bottom: -250px;">Add a Comment:</label>
		   <textarea id="comment" name="commentText" placeholder="Comment here!" required style="margin-left: 10px; margin-bottom: 10px; max-height: 100px;"></textarea>
		   <input type="hidden" name="post" value="{{postData._id}}">
		   <input type="hidden" name="to" value="{{postData.op}}">
		   <input type="hidden" name="toname" value="{{postData.opname}}">
		   <button id="submit" type="submit" class="submit" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; font-size: 16px; cursor: pointer; width: fit-content; align-self: flex-end; margin-top: 200px;">Post Comment</button>
	   </form>
		</div>
	</div>



</body>
</html>